{% extends 'user/settings/base.html' %}
{% from 'bootstrap/form.html' import render_form %}

{% block title %}Change Avatar{% endblock %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static',filename='jcrop/css/jquery.Jcrop.min.css') }}">
{% endblock %}

{% block setting_content %}
    <div class="card bg-light w-100">
        <h3 class="card-header">更换头像</h3>
        <div class="card-body">
            {{ render_form(upload_form, action=url_for('user.upload_avatar')) }}
            <small class="text-muted">图片大小不应超过3M，格式为.jpg或者.png</small>
        </div>
        <div class="card-body">
            {{ avatars.crop_box('main.get_avatar',current_user.avatar_raw) }}  # 渲染裁剪窗口
            {{ avatars.preview_box('main.get_avatar',current_user.avatar_raw) }}  # 渲染预览窗口
        </div>
        <div class="card-body">
            {{ render_form(crop_form, action=url_for('user.crop_avatar')) }}
        </div>
    </div>
{% endblock %}

{% block script %}
    {{ super() }}
    <script src="{{ url_for('static',filename='jcrop/js/jquery.Jcrop.min.js') }}"></script>
    {{ avatars.init_jcrop() }}  # 初始化Jcrop
{% endblock %}